<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IARTES - Sistema de Recomenda√ß√£o de Testes Motorola</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">ü§ñ</span>
                    <span class="logo-text">IARTES</span>
                </div>
                <div class="subtitle">Sistema Inteligente de Recomenda√ß√£o de Testes</div>
            </div>
            <div style="display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 16px;">
                <div class="header-stats" id="headerStats">
                    <div class="stat-item">
                        <span class="stat-label">Testes</span>
                        <span class="stat-value" id="totalTests">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Feedbacks</span>
                        <span class="stat-value" id="totalFeedbacks">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Confian√ßa</span>
                        <span class="stat-value" id="confidence">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Status IA</span>
                        <span class="stat-badge" id="aiStatus">-</span>
                    </div>
                </div>
                <div class="user-info" id="userInfo" style="display: none;">
                    <!-- Notifica√ß√µes -->
                    <div class="notifications-container">
                        <button class="notification-btn" onclick="toggleNotifications()" id="notificationBtn">
                            üîî
                            <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                        </button>
                        <div class="notifications-dropdown" id="notificationsDropdown" style="display: none;">
                            <div class="notifications-header">
                                <h3>Notifica√ß√µes</h3>
                                <button class="btn-link" onclick="markAllNotificationsRead()">Marcar todas como lidas</button>
                            </div>
                            <div class="notifications-list" id="notificationsList">
                                <div class="notification-loading">Carregando...</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Menu do Usu√°rio -->
                    <div class="user-menu-container">
                        <button class="user-menu-btn" onclick="toggleUserMenu()" id="userMenuBtn">
                            <img id="headerProfilePicture" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%23e2e8f0'/%3E%3Ctext x='16' y='20' font-size='18' text-anchor='middle' fill='%2364748b'%3Eüë§%3C/text%3E%3C/svg%3E" alt="Perfil" class="header-profile-picture">
                            <span class="user-name" id="userName">-</span>
                            <span class="menu-arrow">‚ñº</span>
                        </button>
                        <div class="user-menu-dropdown" id="userMenuDropdown" style="display: none;">
                            <div class="user-menu-header">
                                <img id="menuProfilePicture" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='48' height='48'%3E%3Ccircle cx='24' cy='24' r='24' fill='%23e2e8f0'/%3E%3Ctext x='24' y='30' font-size='28' text-anchor='middle' fill='%2364748b'%3Eüë§%3C/text%3E%3C/svg%3E" alt="Perfil" class="menu-profile-picture">
                                <div class="user-menu-info">
                                    <div class="user-menu-name" id="menuUserName">-</div>
                                    <div class="user-menu-email" id="menuUserEmail">-</div>
                                </div>
                            </div>
                            <div class="user-menu-divider"></div>
                            <a href="#" class="user-menu-item" onclick="openProfileModal(); return false;">
                                üë§ Meu Perfil
                            </a>
                            <a href="#" class="user-menu-item" onclick="openPreferencesModal(); return false;">
                                ‚öôÔ∏è Prefer√™ncias
                            </a>
                            <div class="user-menu-divider"></div>
                            <a href="#" class="user-menu-item" onclick="logout(); return false;">
                                üö™ Sair
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab-button active" data-tab="recomendacao">
                    üìã Recomenda√ß√£o
                </button>
                <button class="tab-button" data-tab="feedback">
                    ‚≠ê Dar Feedback
                </button>
                <button class="tab-button" data-tab="pessoais">
                    üë§ Minhas Estat√≠sticas
                </button>
                <button class="tab-button" data-tab="estatisticas">
                    üìä Estat√≠sticas Gerais
                </button>
                <button class="tab-button" data-tab="testes">
                    üì± Todos os Testes
                </button>
                <button class="tab-button" data-tab="anotacoes">
                    üìù Anota√ß√µes
                </button>
            </div>

            <!-- Tab: Recomenda√ß√£o -->
            <div class="tab-content active" id="tab-recomendacao">
                <!-- Etapa 1: Sele√ß√£o de Testes -->
                <div id="step1-selection" class="recommendation-step">
                    <div class="section-header">
                        <h2>üìù Etapa 1: Selecione os Testes que Deseja Executar</h2>
                        <button class="btn btn-primary" onclick="solicitarRecomendacao()" id="btnSolicitar">
                            ü§ñ Solicitar Recomenda√ß√£o de Ordem
                        </button>
                    </div>

                    <div class="filter-bar">
                        <input type="text" id="searchTestsSelect" placeholder="üîç Buscar testes..." class="search-input">
                        <select id="filterModuleSelect" class="filter-select">
                            <option value="">Todos os M√≥dulos</option>
                        </select>
                        <button class="btn btn-secondary" onclick="selecionarTodos()">‚úÖ Selecionar Todos</button>
                        <button class="btn btn-secondary" onclick="limparSelecao()">‚ùå Limpar Sele√ß√£o</button>
                    </div>

                    <div class="test-selection-grid" id="testSelectionGrid">
                        <div class="loading">Carregando testes...</div>
                    </div>

                    <div class="selection-summary" id="selectionSummary" style="display:none;">
                        <strong>Selecionados:</strong> <span id="selectedCount">0</span> testes
                        (<span id="selectedTime">0</span> min estimado)
                    </div>
                </div>

                <!-- Etapa 2: Visualizar e Modificar Recomenda√ß√£o -->
                <div id="step2-recommendation" class="recommendation-step" style="display:none;">
                    <div class="section-header">
                        <h2>üéØ Etapa 2: Ordem Recomendada pela IA</h2>
                        <div class="btn-group">
                            <button class="btn btn-success" onclick="aceitarOrdem()">
                                ‚úÖ Aceitar e Iniciar Execu√ß√£o
                            </button>
                            <button class="btn btn-secondary" onclick="voltarSelecao()">
                                ‚Üê Voltar
                            </button>
                            <button class="btn btn-secondary" onclick="novaRecomendacao()">
                                üîÑ Nova Recomenda√ß√£o
                            </button>
                        </div>
                    </div>

                    <div class="recommendation-info" id="recommendationInfo">
                        <div class="info-card">
                            <div class="info-label">M√©todo</div>
                            <div class="info-value" id="recMethod">-</div>
                        </div>
                        <div class="info-card">
                            <div class="info-label">Confian√ßa</div>
                            <div class="info-value" id="recConfidence">-</div>
                        </div>
                        <div class="info-card">
                            <div class="info-label">Tempo Total</div>
                            <div class="info-value" id="recTime">-</div>
                        </div>
                        <div class="info-card">
                            <div class="info-label">Resets Estimados</div>
                            <div class="info-value" id="recResets">-</div>
                        </div>
                    </div>

                    <div class="info-banner">
                        üí° <strong>Dica:</strong> Voc√™ pode arrastar os testes para reordenar manualmente. A IA aprende com suas modifica√ß√µes!
                    </div>

                    <!-- Explica√ß√£o da IA (NOVO) -->
                    <div id="aiExplanation" class="explanation-card" style="display: none;">
                        <div class="explanation-header">
                            <h3>ü§ñ Por que esta ordem foi recomendada?</h3>
                            <button class="btn-icon" onclick="toggleExplanation()" id="toggleExplanationBtn">
                                ‚ñº
                            </button>
                        </div>
                        <div id="explanationContent" class="explanation-content">
                            <!-- Preenchido via JS -->
                        </div>
                    </div>

                    <div class="test-list" id="recommendedOrder">
                        <div class="loading">Gerando recomenda√ß√£o...</div>
                    </div>
                </div>

                <!-- Etapa 3: Execu√ß√£o Manual (instru√ß√µes) -->
                <div id="step3-execution" class="recommendation-step" style="display:none;">
                    <div class="section-header">
                        <h2>üöÄ Etapa 3: Execute os Testes Manualmente</h2>
                    </div>

                    <div class="execution-instructions">
                        <div class="instruction-card">
                            <h3>üì± Instru√ß√µes de Execu√ß√£o</h3>
                            <ol>
                                <li>Execute cada teste na ordem recomendada abaixo</li>
                                <li>Anote o tempo real de execu√ß√£o de cada teste</li>
                                <li>Registre se o teste passou ou falhou</li>
                                <li>Ap√≥s cada teste, v√° para a aba "‚≠ê Dar Feedback"</li>
                            </ol>
                        </div>

                        <div class="test-list" id="executionOrder">
                            <!-- Preenchido via JS -->
                        </div>
                    </div>

                    <div class="section-actions">
                        <button class="btn btn-primary" onclick="irParaFeedback()">
                            ‚≠ê Ir para Dar Feedback
                        </button>
                        <button class="btn btn-secondary" onclick="voltarSelecao()">
                            üîÑ Nova Recomenda√ß√£o
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tab: Feedback -->
            <div class="tab-content" id="tab-feedback">
                <div class="section-header">
                    <h2>‚≠ê Registrar Feedback de Execu√ß√£o</h2>
                    <p class="subtitle">Ajude a IA a aprender com suas execu√ß√µes</p>
                </div>

                <div class="feedback-form-container">
                    <form id="feedbackForm" class="feedback-form">
                        <div class="form-group">
                            <label for="testSelect">Teste Executado</label>
                            <select id="testSelect" required>
                                <option value="">Selecione um teste...</option>
                            </select>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="actualTime">Tempo Real (segundos)</label>
                                <input type="number" id="actualTime" step="0.1" required>
                            </div>

                            <div class="form-group">
                                <label for="testSuccess">Teste Passou?</label>
                                <select id="testSuccess" required>
                                    <option value="true">‚úÖ Sim</option>
                                    <option value="false">‚ùå N√£o</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="followedRecommendation">Seguiu a Ordem Recomendada?</label>
                                <select id="followedRecommendation" required>
                                    <option value="true">‚úÖ Sim, segui a ordem</option>
                                    <option value="false">‚ùå N√£o, mudei a ordem</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="requiredReset">Precisou Reiniciar?</label>
                                <select id="requiredReset">
                                    <option value="false">N√£o</option>
                                    <option value="true">Sim</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="rating">Avalia√ß√£o da Recomenda√ß√£o (1-5 estrelas)</label>
                            <div class="rating-input" id="ratingInput">
                                <span class="star" data-value="1">‚òÜ</span>
                                <span class="star" data-value="2">‚òÜ</span>
                                <span class="star" data-value="3">‚òÜ</span>
                                <span class="star" data-value="4">‚òÜ</span>
                                <span class="star" data-value="5">‚òÜ</span>
                            </div>
                            <input type="hidden" id="rating" value="5" required>
                            <small style="color:#64748b;display:block;margin-top:8px;">
                                Avalie a qualidade da ordem sugerida pela IA
                            </small>
                        </div>

                        <div class="form-group">
                            <label for="notes">Observa√ß√µes (opcional)</label>
                            <textarea id="notes" rows="3" placeholder="Coment√°rios sobre a execu√ß√£o..."></textarea>
                        </div>

                        <button type="submit" class="btn btn-primary btn-large">
                            ‚úÖ Registrar Feedback
                        </button>
                    </form>

                    <div class="feedback-success" id="feedbackSuccess" style="display: none;">
                        <div class="success-icon">‚úÖ</div>
                        <h3>Feedback Registrado!</h3>
                        <p>O modelo foi atualizado com sucesso</p>
                        <button class="btn btn-secondary" onclick="resetFeedbackForm()">
                            Adicionar Outro Feedback
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tab: Estat√≠sticas Pessoais -->
            <div class="tab-content" id="tab-pessoais">
                <div class="section-header">
                    <h2>üë§ Minhas Estat√≠sticas Pessoais</h2>
                    <p style="color: var(--text-secondary); margin-top: 8px;">
                        Acompanhe seu progresso e o aprendizado do seu modelo personalizado
                    </p>
                </div>

                <!-- Cards de Estat√≠sticas Pessoais -->
                <div class="stats-grid" id="personalStatsGrid">
                    <div class="stat-card">
                        <div class="stat-card-icon">üìù</div>
                        <div class="stat-card-value" id="personalTotalFeedbacks">0</div>
                        <div class="stat-card-label">Meus Feedbacks</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-icon">‚≠ê</div>
                        <div class="stat-card-value" id="personalAvgRating">0.0</div>
                        <div class="stat-card-label">Minha Avalia√ß√£o M√©dia</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-icon">‚úÖ</div>
                        <div class="stat-card-value" id="personalSuccessRate">0%</div>
                        <div class="stat-card-label">Minha Taxa de Sucesso</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-icon">‚è±Ô∏è</div>
                        <div class="stat-card-value" id="personalAvgTime">0s</div>
                        <div class="stat-card-label">Tempo M√©dio de Execu√ß√£o</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-icon">ü§ñ</div>
                        <div class="stat-card-value" id="personalModelSamples">0</div>
                        <div class="stat-card-label">Amostras do Meu Modelo</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-icon">üéØ</div>
                        <div class="stat-card-value" id="personalWeight">-</div>
                        <div class="stat-card-label">Peso de Personaliza√ß√£o</div>
                    </div>
                </div>

                <!-- Compara√ß√£o com M√©dias Globais -->
                <div class="comparison-section">
                    <h3>üìä Compara√ß√£o com M√©dias Globais</h3>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <div class="comparison-label">Avalia√ß√£o M√©dia</div>
                            <div class="comparison-bars">
                                <div class="comparison-bar">
                                    <div class="bar-label">Voc√™</div>
                                    <div class="bar-container">
                                        <div class="bar-fill personal" id="personalRatingBar" style="width: 0%"></div>
                                        <span class="bar-value" id="personalRatingValue">0.0</span>
                                    </div>
                                </div>
                                <div class="comparison-bar">
                                    <div class="bar-label">Global</div>
                                    <div class="bar-container">
                                        <div class="bar-fill global" id="globalRatingBar" style="width: 0%"></div>
                                        <span class="bar-value" id="globalRatingValue">0.0</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="comparison-card">
                            <div class="comparison-label">Taxa de Sucesso</div>
                            <div class="comparison-bars">
                                <div class="comparison-bar">
                                    <div class="bar-label">Voc√™</div>
                                    <div class="bar-container">
                                        <div class="bar-fill personal" id="personalSuccessBar" style="width: 0%"></div>
                                        <span class="bar-value" id="personalSuccessValue">0%</span>
                                    </div>
                                </div>
                                <div class="comparison-bar">
                                    <div class="bar-label">Global</div>
                                    <div class="bar-container">
                                        <div class="bar-fill global" id="globalSuccessBar" style="width: 0%"></div>
                                        <span class="bar-value" id="globalSuccessValue">0%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gr√°ficos Pessoais -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <h3>üìà Minha Evolu√ß√£o de Avalia√ß√µes</h3>
                        <canvas id="personalRatingChart"></canvas>
                    </div>

                    <div class="chart-card">
                        <h3>üì¶ Meus M√≥dulos Preferidos</h3>
                        <canvas id="personalModulesChart"></canvas>
                    </div>
                </div>

                <!-- Status do Modelo Personalizado -->
                <div class="ai-status-card" id="personalAIStatusCard">
                    <h3>ü§ñ Status do Meu Modelo Personalizado</h3>
                    <div class="ai-progress" id="personalAIProgress">
                        <!-- Preenchido via JS -->
                    </div>
                </div>

                <!-- Hist√≥rico Recente -->
                <div class="recent-history-section">
                    <h3>üìã Meu Hist√≥rico Recente de Feedbacks</h3>
                    <div id="personalFeedbackHistory" class="feedback-history-list">
                        <!-- Preenchido via JS -->
                    </div>
                </div>

                <!-- Detec√ß√£o de Anomalias (NOVO) -->
                <div class="anomalies-section">
                    <h3>üîç Detec√ß√£o de Anomalias</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 16px;">
                        O sistema analisa seus feedbacks para identificar padr√µes an√¥malos e problemas potenciais.
                    </p>
                    <button class="btn btn-secondary" onclick="loadAnomalies()">
                        üîç Analisar Meus Feedbacks
                    </button>
                    <div id="anomaliesResults" style="display: none; margin-top: 24px;">
                        <!-- Preenchido via JS -->
                    </div>
                </div>

                <!-- Import√¢ncia de Features (NOVO) -->
                <div class="feature-importance-section">
                    <h3>üìä Import√¢ncia das Features do Modelo</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 16px;">
                        Veja quais fatores o modelo considera mais importantes para fazer recomenda√ß√µes.
                    </p>
                    <button class="btn btn-secondary" onclick="loadFeatureImportance()">
                        üìà Ver Import√¢ncia das Features
                    </button>
                    <div id="featureImportanceChart" style="margin-top: 24px;">
                        <!-- Preenchido via JS -->
                    </div>
                </div>
            </div>

            <!-- Tab: Estat√≠sticas -->
            <div class="tab-content" id="tab-estatisticas">
                <div class="section-header">
                    <h2>üìä Estat√≠sticas e An√°lises</h2>
                </div>

                <div class="stats-grid" id="statsGrid">
                    <div class="stat-card">
                        <div class="stat-card-icon">üìù</div>
                        <div class="stat-card-value" id="statTotalFeedbacks">0</div>
                        <div class="stat-card-label">Total de Feedbacks</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-icon">‚úÖ</div>
                        <div class="stat-card-value" id="statSuccessRate">0%</div>
                        <div class="stat-card-label">Taxa de Sucesso</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-icon">‚≠ê</div>
                        <div class="stat-card-value" id="statAvgRating">0.0</div>
                        <div class="stat-card-label">Avalia√ß√£o M√©dia</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card-icon">üîÑ</div>
                        <div class="stat-card-value" id="statResets">0</div>
                        <div class="stat-card-label">Resets Necess√°rios</div>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-card">
                        <h3>üìà Evolu√ß√£o das Avalia√ß√µes</h3>
                        <canvas id="ratingChart"></canvas>
                    </div>

                    <div class="chart-card">
                        <h3>üì¶ Testes por M√≥dulo</h3>
                        <canvas id="moduleChart"></canvas>
                    </div>
                </div>

                <div class="ai-status-card" id="aiStatusCard">
                    <h3>ü§ñ Status do Modelo de IA</h3>
                    <div class="ai-progress" id="aiProgress">
                        <!-- Preenchido via JS -->
                    </div>
                </div>
            </div>

            <!-- Tab: Todos os Testes -->
            <div class="tab-content" id="tab-testes">
                <div class="section-header">
                    <h2>üì± Todos os Testes Dispon√≠veis</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openCreateTestModal()">
                            ‚ûï Criar Teste Personalizado
                        </button>
                        <button class="btn btn-secondary" onclick="toggleAdvancedFilters()" id="toggleFiltersBtn">
                            üîß Filtros Avan√ßados
                        </button>
                        <button class="btn btn-secondary" onclick="clearAllFilters()">
                            üóëÔ∏è Limpar Filtros
                        </button>
                    </div>
                </div>

                <!-- Barra de busca r√°pida -->
                <div class="filter-bar">
                    <input type="text" id="searchTests" placeholder="üîç Buscar por ID, nome, descri√ß√£o ou m√≥dulo..." 
                           class="search-input" oninput="applyFilters()">
                    <select id="sortBy" class="filter-select" onchange="applyFilters()">
                        <option value="id">Ordenar por: ID</option>
                        <option value="name">Ordenar por: Nome</option>
                        <option value="module">Ordenar por: M√≥dulo</option>
                        <option value="priority">Ordenar por: Prioridade</option>
                        <option value="estimated_time">Ordenar por: Tempo</option>
                    </select>
                    <select id="sortOrder" class="filter-select" onchange="applyFilters()">
                        <option value="asc">Crescente</option>
                        <option value="desc">Decrescente</option>
                    </select>
                </div>

                <!-- Filtros avan√ßados (colaps√°vel) -->
                <div class="advanced-filters" id="advancedFilters" style="display: none;">
                    <div class="filters-grid">
                        <div class="filter-group">
                            <label>M√≥dulo</label>
                            <select id="filterModule" class="filter-select" multiple onchange="applyFilters()">
                                <!-- Preenchido via JS -->
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Prioridade</label>
                            <div class="range-inputs">
                                <input type="number" id="priorityMin" placeholder="M√≠n" min="1" max="5" 
                                       class="filter-input" onchange="applyFilters()">
                                <span>at√©</span>
                                <input type="number" id="priorityMax" placeholder="M√°x" min="1" max="5" 
                                       class="filter-input" onchange="applyFilters()">
                            </div>
                        </div>
                        
                        <div class="filter-group">
                            <label>N√≠vel de Impacto</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" value="destructive" id="filterImpactDestructive" 
                                             onchange="applyFilters()"> üî¥ Destrutivo</label>
                                <label><input type="checkbox" value="partially_destructive" id="filterImpactPartial" 
                                             onchange="applyFilters()"> üü° Parcialmente Destrutivo</label>
                                <label><input type="checkbox" value="non_destructive" id="filterImpactNon" 
                                             onchange="applyFilters()"> üü¢ N√£o-Destrutivo</label>
                            </div>
                        </div>
                        
                        <div class="filter-group">
                            <label>Tempo Estimado (segundos)</label>
                            <div class="range-inputs">
                                <input type="number" id="timeMin" placeholder="M√≠n" min="0" step="0.1" 
                                       class="filter-input" onchange="applyFilters()">
                                <span>at√©</span>
                                <input type="number" id="timeMax" placeholder="M√°x" min="0" step="0.1" 
                                       class="filter-input" onchange="applyFilters()">
                            </div>
                        </div>
                        
                        <div class="filter-group">
                            <label>Tags</label>
                            <select id="filterTags" class="filter-select" multiple onchange="applyFilters()">
                                <!-- Preenchido via JS -->
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Contador de resultados -->
                <div class="results-info" id="resultsInfo" style="display: none;">
                    <span id="resultsCount">0</span> teste(s) encontrado(s)
                </div>

                <div class="test-grid" id="allTests">
                    <div class="loading">Carregando testes...</div>
                </div>
            </div>

            <!-- Tab: Anota√ß√µes -->
            <div class="tab-content" id="tab-anotacoes">
                <div class="section-header">
                    <h2>üìù Anota√ß√µes - Quadro Kanban</h2>
                    <button class="btn btn-primary" onclick="openNewNoteModal()">
                        ‚ûï Nova Anota√ß√£o
                    </button>
                </div>

                <div class="kanban-board" id="kanbanBoard">
                    <div class="kanban-column" data-column="todo">
                        <div class="kanban-column-header">
                            <h3>üìã A Fazer</h3>
                            <span class="note-count" id="count-todo">0</span>
                        </div>
                        <div class="kanban-column-content" id="column-todo" ondrop="handleNoteDrop(event)" ondragover="allowNoteDrop(event)">
                            <!-- Post-its ser√£o inseridos aqui -->
                        </div>
                    </div>

                    <div class="kanban-column" data-column="doing">
                        <div class="kanban-column-header">
                            <h3>üîÑ Em Progresso</h3>
                            <span class="note-count" id="count-doing">0</span>
                        </div>
                        <div class="kanban-column-content" id="column-doing" ondrop="handleNoteDrop(event)" ondragover="allowNoteDrop(event)">
                            <!-- Post-its ser√£o inseridos aqui -->
                        </div>
                    </div>

                    <div class="kanban-column" data-column="done">
                        <div class="kanban-column-header">
                            <h3>‚úÖ Conclu√≠do</h3>
                            <span class="note-count" id="count-done">0</span>
                        </div>
                        <div class="kanban-column-content" id="column-done" ondrop="handleNoteDrop(event)" ondragover="allowNoteDrop(event)">
                            <!-- Post-its ser√£o inseridos aqui -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal: Nova/Editar Anota√ß√£o -->
            <div class="modal" id="noteModal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="noteModalTitle">‚ûï Nova Anota√ß√£o</h2>
                        <button class="modal-close" onclick="closeNoteModal()">√ó</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="noteTitle">T√≠tulo *</label>
                            <input type="text" id="noteTitle" class="form-input" placeholder="Digite o t√≠tulo da anota√ß√£o" maxlength="100">
                        </div>
                        <div class="form-group">
                            <label for="noteContent">Conte√∫do</label>
                            <textarea id="noteContent" class="form-input" rows="5" placeholder="Digite o conte√∫do da anota√ß√£o..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="noteColor">Cor do Post-it</label>
                            <select id="noteColor" class="form-input">
                                <option value="yellow">üü® Amarelo</option>
                                <option value="blue">üü¶ Azul</option>
                                <option value="green">üü© Verde</option>
                                <option value="pink">ü©∑ Rosa</option>
                                <option value="orange">üüß Laranja</option>
                                <option value="purple">üü™ Roxo</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="noteColumn">Coluna</label>
                            <select id="noteColumn" class="form-input">
                                <option value="todo">üìã A Fazer</option>
                                <option value="doing">üîÑ Em Progresso</option>
                                <option value="done">‚úÖ Conclu√≠do</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="saveNote()">üíæ Salvar</button>
                            <button class="btn btn-secondary" onclick="closeNoteModal()">‚ùå Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal: Criar/Editar Teste Personalizado -->
            <div class="modal" id="createTestModal" style="display: none;">
                <div class="modal-content modal-large">
                    <div class="modal-header">
                        <h2 id="createTestModalTitle">‚ûï Criar Teste Personalizado</h2>
                        <button class="modal-close" onclick="closeCreateTestModal()">√ó</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="testId">ID do Teste *</label>
                            <input type="text" id="testId" class="form-input" placeholder="Ex: TC-USER-001" maxlength="50">
                            <small class="form-help">Identificador √∫nico do teste (sem espa√ßos)</small>
                        </div>
                        <div class="form-group">
                            <label for="testName">Nome do Teste *</label>
                            <input type="text" id="testName" class="form-input" placeholder="Ex: Validar Login do Usu√°rio" maxlength="200">
                        </div>
                        <div class="form-group">
                            <label for="testDescription">Descri√ß√£o</label>
                            <textarea id="testDescription" class="form-input" rows="3" placeholder="Descreva o objetivo do teste..."></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="testModule">M√≥dulo</label>
                                <input type="text" id="testModule" class="form-input" placeholder="Ex: Autentica√ß√£o" maxlength="100">
                            </div>
                            <div class="form-group">
                                <label for="testPriority">Prioridade</label>
                                <select id="testPriority" class="form-input">
                                    <option value="1">1 - Muito Baixa</option>
                                    <option value="2">2 - Baixa</option>
                                    <option value="3" selected>3 - M√©dia</option>
                                    <option value="4">4 - Alta</option>
                                    <option value="5">5 - Muito Alta</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="testImpact">N√≠vel de Impacto</label>
                                <select id="testImpact" class="form-input">
                                    <option value="non_destructive" selected>üü¢ N√£o-Destrutivo</option>
                                    <option value="partially_destructive">üü° Parcialmente Destrutivo</option>
                                    <option value="destructive">üî¥ Destrutivo</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="testTags">Tags (separadas por v√≠rgula)</label>
                            <input type="text" id="testTags" class="form-input" placeholder="Ex: login, autentica√ß√£o, UI">
                            <small class="form-help">Use v√≠rgulas para separar m√∫ltiplas tags</small>
                        </div>
                        
                        <div class="form-group">
                            <label>A√ß√µes do Teste</label>
                            <div id="testActionsContainer">
                                <!-- A√ß√µes ser√£o adicionadas aqui -->
                            </div>
                            <button type="button" class="btn btn-secondary" onclick="addTestAction()" style="margin-top: 12px;">
                                ‚ûï Adicionar A√ß√£o
                            </button>
                        </div>
                        
                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="saveUserTest()">üíæ Salvar Teste</button>
                            <button class="btn btn-secondary" onclick="closeCreateTestModal()">‚ùå Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal: Perfil -->
            <div class="modal" id="profileModal" style="display: none;">
                <div class="modal-content modal-large">
                    <div class="modal-header">
                        <h2>üë§ Meu Perfil</h2>
                        <button class="modal-close" onclick="closeProfileModal()">√ó</button>
                    </div>
                    <div class="modal-body">
                        <div class="profile-container">
                    <!-- Foto de Perfil -->
                    <div class="profile-picture-section">
                        <div class="profile-picture-container">
                            <img id="profilePicture" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='150' height='150'%3E%3Ccircle cx='75' cy='75' r='75' fill='%23e2e8f0'/%3E%3Ctext x='75' y='95' font-size='80' text-anchor='middle' fill='%2364748b'%3Eüë§%3C/text%3E%3C/svg%3E" alt="Foto de Perfil" class="profile-picture">
                            <button class="btn btn-secondary" onclick="document.getElementById('profilePictureInput').click()">
                                üì∑ Alterar Foto
                            </button>
                            <input type="file" id="profilePictureInput" accept="image/*" style="display: none;" onchange="uploadProfilePicture(event)">
                        </div>
                    </div>

                    <!-- Formul√°rio de Edi√ß√£o -->
                    <div class="profile-form">
                        <div class="form-group">
                            <label for="profileUsername">Nome de Usu√°rio</label>
                            <input type="text" id="profileUsername" class="form-input" readonly>
                            <small class="form-help">O nome de usu√°rio n√£o pode ser alterado</small>
                        </div>

                        <div class="form-group">
                            <label for="profileFullName">Nome Completo</label>
                            <input type="text" id="profileFullName" class="form-input" placeholder="Seu nome completo">
                        </div>

                        <div class="form-group">
                            <label for="profileEmail">Email</label>
                            <input type="email" id="profileEmail" class="form-input" placeholder="seu@email.com">
                        </div>

                        <div class="form-group">
                            <label for="profileExperienceLevel">N√≠vel de Experi√™ncia</label>
                            <select id="profileExperienceLevel" class="form-input">
                                <option value="beginner">Iniciante</option>
                                <option value="intermediate">Intermedi√°rio</option>
                                <option value="advanced">Avan√ßado</option>
                                <option value="expert">Especialista</option>
                            </select>
                            <small class="form-help">Alterar o n√≠vel de experi√™ncia pode afetar as recomenda√ß√µes da IA</small>
                        </div>

                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="saveProfile()">
                                üíæ Salvar Altera√ß√µes
                            </button>
                        </div>
                    </div>

                    <!-- Alterar Senha -->
                    <div class="profile-section">
                        <h3>üîí Alterar Senha</h3>
                        <div class="form-group">
                            <label for="currentPassword">Senha Atual</label>
                            <input type="password" id="currentPassword" class="form-input" placeholder="Digite sua senha atual">
                        </div>
                        <div class="form-group">
                            <label for="newPassword">Nova Senha</label>
                            <input type="password" id="newPassword" class="form-input" placeholder="Digite a nova senha">
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Confirmar Nova Senha</label>
                            <input type="password" id="confirmPassword" class="form-input" placeholder="Confirme a nova senha">
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="changePassword()">
                                üîë Alterar Senha
                            </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Modal: Prefer√™ncias -->
            <div class="modal" id="preferencesModal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>‚öôÔ∏è Prefer√™ncias</h2>
                        <button class="modal-close" onclick="closePreferencesModal()">√ó</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="themeSelectModal">Tema da Interface</label>
                            <select id="themeSelectModal" class="form-input" onchange="changeTheme(this.value)">
                                <option value="light">üåû Claro</option>
                                <option value="dark">üåô Escuro</option>
                                <option value="auto">üîÑ Autom√°tico (Sistema)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="notificationsEnabledModal" onchange="updateNotificationPreference()">
                                <span>Receber notifica√ß√µes</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="emailNotificationsModal" onchange="updateNotificationPreference()">
                                <span>Notifica√ß√µes por email</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>IARTES - Sistema Inteligente de Recomenda√ß√£o de Testes | Powered by Machine Learning (Random Forest)</p>
        </div>
    </footer>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script src="/static/js/app.js"></script>
</body>
</html>
